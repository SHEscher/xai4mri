
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Transferring, training & interpreting deep learning-based predictions on MR images.">
      
      
      
        <link rel="canonical" href="https://SHEscher.github.io/xai4mri/dataloading/">
      
      
        <link rel="prev" href="../installation/">
      
      
        <link rel="next" href="../models/">
      
      
      <link rel="icon" href="../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Loading data - xai4mri</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/style.css">
    
      <link rel="stylesheet" href="../css/material.css">
    
      <link rel="stylesheet" href="../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#loading-mri-datasets" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="xai4mri" class="md-header__button md-logo" aria-label="xai4mri" data-md-component="logo">
      
  <img src="../brain.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            xai4mri
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Loading data
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/SHEscher/xai4mri" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SHEscher/xai4mri
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../overview/" class="md-tabs__link">
          
  
    
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../reference/" class="md-tabs__link">
          
  
    
  
  Code

        </a>
      </li>
    
  

    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="xai4mri" class="md-nav__button md-logo" aria-label="xai4mri" data-md-component="logo">
      
  <img src="../brain.svg" alt="logo">

    </a>
    xai4mri
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/SHEscher/xai4mri" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SHEscher/xai4mri
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href=".." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Home
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Loading data
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Loading data
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prepare-your-research-data" class="md-nav__link">
    <span class="md-ellipsis">
      Prepare your research data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prepare your research data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mri-data" class="md-nav__link">
    <span class="md-ellipsis">
      MRI data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#study-table" class="md-nav__link">
    <span class="md-ellipsis">
      Study table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implement-your-own-dataset-class" class="md-nav__link">
    <span class="md-ellipsis">
      Implement your own dataset class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implement your own dataset class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instantiate-your-dataset-class" class="md-nav__link">
    <span class="md-ellipsis">
      Instantiate your dataset class
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-data-split-for-model-training-and-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Create a data split for model training and evaluation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create a data split for model training and evaluation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keep-track-of-data-splits" class="md-nav__link">
    <span class="md-ellipsis">
      Keep track of data splits
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Keep track of data splits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save-data-splits" class="md-nav__link">
    <span class="md-ellipsis">
      Save data splits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-data-splits" class="md-nav__link">
    <span class="md-ellipsis">
      Load data splits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model training
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transfer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model transfer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../interpretation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model interpretation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Code
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> xai4mri
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> xai4mri
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/dataloader/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> dataloader
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2" id="__nav_3_1_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> dataloader
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/dataloader/datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/dataloader/mri_dataloader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> mri_dataloader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/dataloader/mri_registration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> mri_registration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/dataloader/prune_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> prune_image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/dataloader/transformation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> transformation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/model/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> model
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_3" id="__nav_3_1_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/model/interpreter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> interpreter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/model/mrinets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> mrinets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/model/transfer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> transfer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1_1_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/visualizer/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> visualizer
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_5" id="__nav_3_1_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> visualizer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/visualizer/visualize_heatmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> visualize_heatmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/visualizer/visualize_mri/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> visualize_mri
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coverage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coverage report
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prepare-your-research-data" class="md-nav__link">
    <span class="md-ellipsis">
      Prepare your research data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prepare your research data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mri-data" class="md-nav__link">
    <span class="md-ellipsis">
      MRI data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#study-table" class="md-nav__link">
    <span class="md-ellipsis">
      Study table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implement-your-own-dataset-class" class="md-nav__link">
    <span class="md-ellipsis">
      Implement your own dataset class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implement your own dataset class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instantiate-your-dataset-class" class="md-nav__link">
    <span class="md-ellipsis">
      Instantiate your dataset class
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-data-split-for-model-training-and-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Create a data split for model training and evaluation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create a data split for model training and evaluation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keep-track-of-data-splits" class="md-nav__link">
    <span class="md-ellipsis">
      Keep track of data splits
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Keep track of data splits">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save-data-splits" class="md-nav__link">
    <span class="md-ellipsis">
      Save data splits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-data-splits" class="md-nav__link">
    <span class="md-ellipsis">
      Load data splits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="loading-mri-datasets">Loading MRI datasets<a class="headerlink" href="#loading-mri-datasets" title="Permanent link">ðŸ§ </a></h1>
<p>MRI datasets can be huge.
<code>xai4mri</code> provides a simple way to load MRI datasets in a memory-efficient way.
Moreover, <code>xai4mri</code> prepares the data for training and evaluation of deep learning models.</p>
<h2 id="prepare-your-research-data">Prepare your research data<a class="headerlink" href="#prepare-your-research-data" title="Permanent link">ðŸ§ </a></h2>
<p>Your study data must be prepared to match the schema of the <code>xai4mri</code> package.</p>
<p>It is recommended to use the <a href="https://bids.neuroimaging.io">BIDS</a> format for structuring MRI data and
derivatives, as well as to provide a corresponding study table (<code>*.tsv</code>, <code>*.csv</code>).
However, the functions in <code>xai4mri.dataloader.datasets</code> allow for other data structures as well.</p>
<h3 id="mri-data">MRI data<a class="headerlink" href="#mri-data" title="Permanent link">ðŸ§ </a></h3>
<p>It is expected that the background in MRI data is set to zero.
Statistical maps with negative and positive values are possible when the background remains set to zero.</p>
<p>In the case, multiple MRI sequences and/or derivatives (including statistical maps) are present, but not for
all subjects (<code>sid</code>), create separate dataset classes (see <a href="#implement-your-own-dataset-class">below</a>) for each MRI sequence and/or derivative with their own
corresponding study table.</p>
<div class="admonition question inline end">
<p class="admonition-title">Why using <code>sid</code>?</p>
<p>The <code>sid</code> column will become the index of a
<a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html"><code>pandas.DataFrame</code></a>,
which is passed across the <code>xai4mri</code> package.</p>
</div>
<h3 id="study-table">Study table<a class="headerlink" href="#study-table" title="Permanent link">ðŸ§ </a></h3>
<p>Importantly, subject IDs (<code>sid</code>) in the study table must correspond to existing MRI data.
The first column of the study table must contain subject ID's and must be called '<code>sid</code>'.</p>
<p>See the example below:</p>
<details class="example">
<summary>Example study table</summary>
<table>
<thead>
<tr>
<th>sid</th>
<th>age</th>
<th>condition</th>
</tr>
</thead>
<tbody>
<tr>
<td>sub-01</td>
<td>25</td>
<td>control</td>
</tr>
<tr>
<td>sub-02</td>
<td>30</td>
<td>patient</td>
</tr>
<tr>
<td>sub-03</td>
<td>35</td>
<td>control</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>sub-99</td>
<td>45</td>
<td>patient</td>
</tr>
</tbody>
</table>
</details>
<h2 id="implement-your-own-dataset-class">Implement your own dataset class<a class="headerlink" href="#implement-your-own-dataset-class" title="Permanent link">ðŸ§ </a></h2>
<p>Inherit from the <code>BaseDataSet</code> to create a new dataset class, as shown in the example below:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">xai4mri.dataloader</span> <span class="kn">import</span> <span class="n">BaseDataSet</span>


<span class="k">class</span> <span class="nc">MyStudy</span><span class="p">(</span><span class="n">BaseDataSet</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">study_table_or_path</span><span class="o">=</span><span class="s2">&quot;PATH/TO/STUDY_TABLE.csv&quot;</span><span class="p">,</span>  <span class="c1"># or `*.tsv` OR table as `pd.DataFrame`</span>
            <span class="n">project_id</span><span class="o">=</span><span class="s2">&quot;MyStudy&quot;</span><span class="p">,</span>  <span class="c1"># this can be shared across multiple dataset classes</span>
            <span class="n">mri_sequence</span><span class="o">=</span><span class="s2">&quot;t1w&quot;</span><span class="p">,</span>  <span class="c1"># this should be unique for each dataset class</span>
            <span class="n">cache_dir</span><span class="o">=</span><span class="s2">&quot;PATH/WHERE/TO/CACHE/PROCESSED/DATA&quot;</span><span class="p">,</span>
            <span class="n">load_mode</span><span class="o">=</span><span class="s2">&quot;full_array&quot;</span><span class="p">,</span>  <span class="c1"># use &quot;file_path&quot; for very large datasets (N&gt;&gt;2,500)</span>
            <span class="c1"># Optional kwargs for how to load/process MRIs</span>
            <span class="n">norm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Normalize MRI data</span>
            <span class="n">prune_mode</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>  <span class="c1"># Pruning means to minimize the background in the MRIs.</span>
        <span class="p">)</span>

    <span class="c1"># This class method must be implemented</span>
    <span class="k">def</span> <span class="nf">mri_path_constructor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct the path to the MRI of a given subject for MyStudy.</span>

<span class="sd">        MRI data will be loaded using nibabel from given paths.</span>

<span class="sd">        :param sid: subject ID</span>
<span class="sd">        :return: absolute file path to MRI of the subject with the given ID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;PATH/TO/MRI&quot;</span><span class="p">,</span> <span class="n">sid</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;MNI/2mm/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mri_sequence</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">w_brain.nii.gz&quot;</span><span class="p">)</span>
</code></pre></div>
<details class="note">
<summary>About **kwargs in <code>BaseDataSet.__init__()</code></summary>
<p>Find details to additional <code>kwargs</code> in docs of <code>_load_data_as_full_array()</code> or <code>_load_data_as_file_paths()</code> in
<code>xai4mri.dataloader.mri_dataloader</code>.</p>
</details>
<p><code>BaseDataSet</code> provides several attributes and methods, see details in <a href="../reference/dataloader/datasets/">API reference</a></p>
<details class="note" open="open">
<summary>MRI pruning for model efficiency</summary>
<p>The <code>prune_mode</code> parameter is used to minimize the background in MRIs.
This is useful for training deep learning models, since the models can become substantially smaller,
avoiding redundant parameters.
Set <code>prune_mode</code> to <code>None</code> if this is not desired.
In how far MRIs are pruned can be adjusted with the <code>PruneConfig</code> object:</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">xai4mri.dataloader.prune_image</span> <span class="kn">import</span> <span class="n">PruneConfig</span>

<span class="c1"># Check the defeault size of the &quot;largest brain&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">PruneConfig</span><span class="o">.</span><span class="n">largest_brain_max_axes</span><span class="p">)</span>

<span class="c1"># Adapt the size of the &quot;largest brain&quot; to your dataset</span>
<span class="n">PruneConfig</span><span class="o">.</span><span class="n">largest_brain_max_axes</span> <span class="o">=</span> <span class="p">(</span><span class="mi">185</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">220</span><span class="p">)</span>  <span class="c1"># always use 1mm isotropic resolution here</span>
<span class="c1"># Note that xai4mri uses the &#39;LIA&#39; orientation.</span>
</code></pre></div>
Image pruning will adhere to the settings in <code>PruneConfig.largest_brain_max_axes</code>.
During pruning <code>xai4mri</code> automatically adjusts the axes lengths to the resolution of the given MRI dataset.
To reverse this process, see <a href="../interpretation/#reverse-pruning-bringing-model-input-and-relevance-maps-back-to-the-nifti-format">Reverse pruning</a></p>
<p>If you are note sure, which values to use for your case, you can use the default values,
or run the <code>get_brain_axes_length()</code> in the <code>xai4mri.dataloader.prune_image</code> submodule over your MRI dataset.
Then, choose the largest values you found such that all brains will get pruned
without cutting off any brain voxels.</p>
</details>
<h3 id="instantiate-your-dataset-class">Instantiate your dataset class<a class="headerlink" href="#instantiate-your-dataset-class" title="Permanent link">ðŸ§ </a></h3>
<p>Use your project-specific dataset class to process and load data:</p>
<div class="highlight"><pre><span></span><code><span class="n">mydata</span> <span class="o">=</span> <span class="n">MyStudy</span><span class="p">()</span>
</code></pre></div>
<p>Processing data might require some time.
To get an estimate of cache storage and processing time, use the following:</p>
<div class="highlight"><pre><span></span><code><span class="n">mydata</span><span class="o">.</span><span class="n">get_size_of_prospective_mri_set</span><span class="p">()</span>
</code></pre></div>
<p>Then get the data.
If the data has not been processed yet, this will take some time.
After that, the whole data set can be loaded within seconds.</p>
<div class="highlight"><pre><span></span><code><span class="n">volume_data</span><span class="p">,</span> <span class="n">sid_list</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
<details class="note">
<summary>One more time about **kwargs</summary>
<p>As mentioned above, <code>**kwargs</code> are passed to the <code>_load_data_as_file_paths</code> or
<code>_load_data_as_full_array</code> in <code>xai4mri.Dataloader.mri_dataloader</code> method.</p>
<p>If values that were set at the implementation <code>MyStudy()</code> are not desired,
they can be passed to <code>get_data()</code>;
e.g., getting data with normalization would be archived with
<code>mydata.get_data(norm=True)</code>, this overwrites the initially set <code>norm=False</code> (see above).</p>
</details>
<h2 id="create-a-data-split-for-model-training-and-evaluation">Create a data split for model training and evaluation<a class="headerlink" href="#create-a-data-split-for-model-training-and-evaluation" title="Permanent link">ðŸ§ </a></h2>
<p>For the training of deep learning models, we need to prepare the data split:</p>
<div class="highlight"><pre><span></span><code><span class="n">split_dict</span><span class="p">,</span> <span class="n">train_data_gen</span><span class="p">,</span> <span class="n">val_data_gen</span><span class="p">,</span> <span class="n">test_data_gen</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="n">create_data_split</span><span class="p">(</span>
    <span class="n">target</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">split_ratio</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="n">split_dict</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>target</code> variable must be a column in the study table.</p>
</div>
<p>The returned data generators can be used directly for the training of deep learning models
based on <code>TensorFlow</code> / <code>Keras</code>.</p>
<p>Also, ideally use a small batch size (<code>batch_size</code>) when GPUs are used,
since their memory is easily exhausted with relatively big MRIs as model input.</p>
<h3 id="keep-track-of-data-splits">Keep track of data splits<a class="headerlink" href="#keep-track-of-data-splits" title="Permanent link">ðŸ§ </a></h3>
<p><code>split_dict</code> can be used when specific subject ID's shall reside in specific splits.
For instance, if you are interested in model predictions for specific subjects, put their ID's (SID's) in
the test set:</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">split_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sid_45&quot;</span><span class="p">,</span> <span class="s2">&quot;sid_33&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="s2">&quot;validation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sid_29&quot;</span><span class="p">,</span> <span class="s2">&quot;sid_11&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sid_1&quot;</span><span class="p">,</span> <span class="s2">&quot;sid_99&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>If <code>split_dict</code> is provided to the function above, the <code>split_ratio</code> is ignored. Therefore, choose the
respective lists of SID's (<em>train</em>, <em>validation</em>, <em>test</em>) such that a desired ratio is achieved.</p>
<h4 id="save-data-splits">Save data splits<a class="headerlink" href="#save-data-splits" title="Permanent link">ðŸ§ </a></h4>
<p>If a split dictionary should be saved, use the following:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Save latest data split</span>
<span class="n">save_path</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="n">save_split_dict</span><span class="p">()</span>  <span class="c1"># this outputs the path to the saved split dictionary</span>

<span class="c1"># Alternatively, save a data split to a specified path</span>
<span class="n">save_path</span> <span class="o">=</span> <span class="s2">&quot;PATH/TO/SAVE/SPLIT/TO&quot;</span>  <span class="c1"># Optional: define your own path, otherwise None for the default path</span>
<span class="n">mydata</span><span class="o">.</span><span class="n">save_split_dict</span><span class="p">(</span><span class="n">split_dict</span><span class="o">=</span><span class="n">split_dict</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="n">save_path</span><span class="p">)</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Keep track of your data splits</p>
<p>For later reproducibility, but also model interpretation,
it is essential that you know which subject data was used for training and evaluation.
Usually, the XAI-based interpretation of model predictions is done on the test set.</p>
</div>
<h4 id="load-data-splits">Load data splits<a class="headerlink" href="#load-data-splits" title="Permanent link">ðŸ§ </a></h4>
<p>Loading a split dictionary is done with:</p>
<div class="highlight"><pre><span></span><code><span class="n">split_dict</span> <span class="o">=</span> <span class="n">mydata</span><span class="o">.</span><span class="n">load_split_dict</span><span class="p">(</span><span class="n">split_dict_path</span><span class="o">=</span><span class="n">save_path</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../installation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Installation">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Installation
              </div>
            </div>
          </a>
        
        
          
          <a href="../models/" class="md-footer__link md-footer__link--next" aria-label="Next: Model training">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Model training
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
        <script src="../assets/_markdown_exec_pyodide.js"></script>
      
    
  </body>
</html>